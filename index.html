<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Quanto mi ami davvero?</title>
  <link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Inter:wght@400;700&display=swap" rel="stylesheet">
  <style>
    /* Variabili CSS */
    :root {
      /* Colori Fase 1 (basati sull'immagine del coniglio e corvo) */
      --intro-bg-color: #fef1f5; /* Rosa chiaro, come nel tuo esempio */
      --intro-text-color: #333;
      --intro-clickable-bg: #ffb6c1; /* Rosa un po' pi√π scuro per il bottone */
      --intro-clickable-hover: #ffc8d3;

      /* Colori Fase 2 (basati sull'immagine del corvo singolo) */
      --quiz-bg-color: #E8E6FC; /* Lavanda molto chiaro, come lo sfondo dominante dell'immagine del corvo */
      --quiz-text-color: #333; /* Testo scuro per contrasto con lo sfondo chiaro */
      --quiz-font: 'Inter', sans-serif; /* Un font pi√π serio per la fase 2 */
      --quiz-primary-color: #6a05ad; /* Viola scuro/intenso, come i dettagli del corvo */
      --quiz-button-hover-color: #8b008b; /* Viola pi√π chiaro per l'hover */
      --quiz-border-color: #c0b8e8; /* Un bordo leggermente viola chiaro */
      --quiz-container-bg: #f5f3ff; /* Un lilla molto chiaro per il container */
      --quiz-shadow-color: rgba(0, 0, 0, 0.15); /* Ombra leggera */

      --quiz-question-color: #4A037F; /* Viola scuro per le domande, come discusso */

      --transition-speed: 0.8s; /* Velocit√† di transizione tra le fasi */
    }

    body {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: var(--intro-bg-color); /* Rosa chiaro */
      color: var(--intro-text-color);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      transition: all 0.8s ease;
      text-align: center;
    }

    #container {
      max-width: 90%; /* Default per intro */
      width: 100%; /* Per occupare la larghezza disponibile */
      padding: 20px; /* Padding default */
      box-sizing: border-box;
    }

    /* Stili Fase 2 (Pre-Quiz, Quiz e Finale - tutto basato sull'immagine del corvo) */
    body.phase-2 {
        background-color: var(--quiz-bg-color); /* Lavanda chiaro */
        color: var(--quiz-text-color);
        font-family: var(--quiz-font);
    }
    .container.phase-2 {
        background-color: var(--quiz-container-bg); /* Lilla chiaro per il container */
        box-shadow: 0 8px 20px var(--quiz-shadow-color);
        max-width: 95%; /* Pi√π largo del 90% per i quiz */
        padding: 30px 20px; /* Pi√π spazio in alto/basso, meno ai lati per il design */
    }

    .hidden {
      display: none;
    }

    .clickable {
      margin-top: 20px;
      padding: 15px 25px;
      font-size: 1.1rem;
      background-color: var(--intro-clickable-bg); /* Rosa per il bottone */
      color: var(--intro-text-color);
      border-radius: 8px;
      cursor: pointer;
      transition: 0.3s;
    }

    .clickable:hover {
      background-color: var(--intro-clickable-hover); /* Rosa pi√π chiaro all'hover */
    }

    #intro-image {
        width: 150px;
        height: 150px;
        border-radius: 50%;
        object-fit: cover;
        cursor: pointer;
        transition: transform 0.3s ease-out, box-shadow 0.3s ease-out;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        margin-top: 20px; /* Spazio sotto il testo */
    }
    #intro-image:hover {
        transform: scale(1.05);
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
    }


    .phase-2 h1, .phase-2 h2 {
        color: var(--quiz-primary-color);
        margin-bottom: 25px;
        font-weight: 700;
    }

    .question-section {
        margin-bottom: 30px;
        text-align: left;
    }

    .question-section p {
      font-size: 1.15em;
      margin-bottom: 15px;
      color: var(--quiz-question-color); /* Colore delle domande */
      font-weight: bold; /* Grassetto per le domande */
    }

    /* Stile per le opzioni del quiz (label dei radio button) */
    .options label {
        display: block;
        background-color: var(--quiz-container-bg); /* Un lilla chiaro come base */
        padding: 15px;
        margin-bottom: 10px;
        border-radius: 8px; /* Bordi arrotondati */
        cursor: pointer;
        transition: background-color 0.3s ease, border-color 0.3s ease;
        border: 1px solid var(--quiz-border-color); /* Bordo leggermente viola */
        font-size: 1em;
        color: var(--quiz-text-color);
    }

    .options label:hover {
        background-color: #dcd7f5; /* Un lilla leggermente pi√π scuro per l'hover */
        border-color: var(--quiz-primary-color); /* Il riflesso viola sul bordo */
    }

    .options input[type="radio"] {
        display: none; /* Nasconde i radio button nativi */
    }

    /* Stile quando l'opzione √® selezionata */
    .options input[type="radio"]:checked + label {
        background-color: var(--quiz-primary-color); /* Sfondo viola quando selezionato */
        border-color: var(--quiz-primary-color);
        color: white; /* Testo bianco */
    }

    /* Stile per tutti i bottoni nella Fase 2 (Inizia Quiz, Scopri la tua verit√†, Navigazione) */
    .phase-2 button {
        background-color: var(--quiz-primary-color);
        color: white;
        border: none;
        padding: 15px 25px;
        border-radius: 8px; /* Bordi arrotondati */
        font-size: 1.1em;
        cursor: pointer;
        transition: background-color 0.3s ease, transform 0.2s ease;
        margin-top: 20px;
    }

    .phase-2 button:hover {
        background-color: var(--quiz-button-hover-color); /* Viola pi√π chiaro all'hover */
        transform: translateY(-2px);
    }

    .phase-2 button:disabled {
        background-color: #999; /* Grigio pi√π chiaro per bottone disabilitato */
        cursor: not-allowed;
        transform: translateY(0); /* Rimuovi l'effetto sollevamento per i disabilitati */
    }

    #quiz-navigation {
        display: flex;
        justify-content: space-between;
        margin-top: 20px;
    }
    #quiz-navigation button {
        flex-grow: 1; /* Occupano lo spazio disponibile */
        margin: 0 5px; /* Spazio tra i bottoni */
    }
    #quiz-navigation button:first-child { margin-left: 0; }
    #quiz-navigation button:last-child { margin-right: 0; }


    #final-phrase {
        font-size: 1.4em;
        font-style: italic;
        margin-bottom: 30px;
        color: var(--quiz-primary-color);
        word-wrap: break-word;
    }

    #final-image {
        width: 150px; /* Aumento la dimensione per renderla pi√π cliccabile per la condivisione */
        height: 150px;
        margin-top: 20px;
        cursor: pointer;
        transition: transform 0.3s ease-out;
        border-radius: 50%;
        box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }

    #final-image:hover {
        transform: scale(1.1);
        box-shadow: 0 6px 12px rgba(0,0,0,0.3);
    }

    /* Gestione delle sezioni con opacit√† per transizioni fluide */
    .page-section {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        padding: inherit;
        box-sizing: border-box;
        opacity: 0;
        pointer-events: none;
        transition: opacity var(--transition-speed) ease-in-out, transform var(--transition-speed) ease-in-out;
        transform: translateY(20px);
        display: flex; /* Uso flexbox per centrare il contenuto di ogni sezione */
        flex-direction: column;
        align-items: center;
        justify-content: center;
        min-height: 100vh; /* Occupano l'intera altezza del viewport */
    }

    .page-section.active {
        opacity: 1;
        pointer-events: all;
        transform: translateY(0);
        position: static; /* Occupare spazio quando attiva */
    }

    /* Nascondi gli elementi HTML inattivi per non occupare spazio nel DOM */
    .page-section:not(.active) {
        display: none;
    }

    /* Specifiche per il container durante la transizione tra intro e quiz */
    .container.transitioning {
        overflow: hidden;
    }


    /* Media queries per una migliore responsivit√† */
    @media (max-width: 600px) {
        .container {
            padding: 20px;
            margin: 10px;
        }

        .phase-1 h1 {
            font-size: 2em;
        }

        .phase-2 h1, .phase-2 h2 {
            font-size: 1.6em;
        }

        .question-section p {
            font-size: 1em;
        }

        .options label {
            padding: 12px;
            font-size: 0.95em;
        }

        .phase-2 button {
            padding: 12px 20px;
            font-size: 1em;
        }

        #final-phrase {
            font-size: 1.2em;
        }
        #quiz-navigation {
            flex-direction: column; /* Bottoni di navigazione impilati su mobile */
        }
        #quiz-navigation button {
            width: 100%;
            margin-top: 10px; /* Spazio tra i bottoni impilati */
        }
    }
  </style>
</head>
<body class="phase-1">
  <div id="container">

    <div id="intro" class="page-section active">
      <h1>Quanto mi ami davvero?</h1>
      <p>Clicca qui e te lo dimostro a modo mio.</p>
      <img src="corvocarino.JPG" alt="Cliccami per scoprire" id="intro-image">
      <div class="clickable" id="intro-clickable-button">üíó CLICCAMI üíó</div>
    </div>

    <div id="pre-quiz-section" class="page-section">
        <h2>Ora che hai cliccato‚Ä¶ vediamo il tuo lato nascosto.</h2>
        <button id="start-quiz-button">Inizia il Quiz</button>
    </div>

    <div id="quiz-section" class="page-section">
        <div id="quizContent">
            </div>
        <div id="quiz-navigation">
            <button id="prev-question-button" class="hidden">Precedente</button>
            <button id="next-question-button">Successivo</button>
            <button id="submit-quiz" class="hidden" disabled>Scopri la tua verit√†</button>
        </div>
    </div>

    <div id="result-section" class="page-section">
      <h2>La verit√† non consola. Ma almeno ti guarda in faccia.</h2>
      <ul id="summary" style="list-style: none; padding: 0;"></ul>
      <img src="corvo.JPG" alt="Condividi su WhatsApp" id="final-image">
    </div>
  </div>

  <script>
    const introSection = document.getElementById('intro');
    const introImage = document.getElementById('intro-image');
    const introClickableButton = document.getElementById('intro-clickable-button');
    const preQuizSection = document.getElementById('pre-quiz-section');
    const startQuizButton = document.getElementById('start-quiz-button');
    const quizSection = document.getElementById('quiz-section');
    const quizContent = document.getElementById('quizContent');
    const prevButton = document.getElementById('prev-question-button');
    const nextButton = document.getElementById('next-question-button');
    const submitButton = document.getElementById('submit-quiz');
    const resultSection = document.getElementById('result-section');
    const mainContainer = document.getElementById('container');
    const body = document.body;
    const finalImage = document.getElementById('final-image');

    const quizData = [
      {
        question: "Cosa speri che non vedano nei tuoi occhi?",
        options: ["La stanchezza", "La rabbia", "Il senso di colpa", "Il vuoto"]
      },
      {
        question: "Cosa dici quando stai male?",
        options: ["'Sto solo pensando'", "'Sono stanco'", "'Lasciami un po‚Äô di spazio'", "Niente"]
      },
      {
        question: "A chi racconti la tua versione peggiore?",
        options: ["Nessuno", "A chi non potr√† ferirmi", "A chi amo", "A me stesso"]
      },
      {
        question: "Cosa ti ferisce di pi√π?",
        options: ["Essere dimenticato", "Non essere capito", "Sentirmi inadeguato", "Essere visto, davvero"]
      }
    ];

    let userAnswers = new Array(quizData.length).fill(undefined);
    let currentQuestionIndex = 0;

    function changeSection(hideSection, showSection, newBodyClass = null, newContainerClass = null) {
        hideSection.classList.remove('active');
        mainContainer.classList.add('transitioning');

        setTimeout(() => {
            hideSection.style.display = 'none';

            if (newBodyClass) {
                body.className = newBodyClass;
            }
            if (newContainerClass) {
                mainContainer.className = newContainerClass;
            }

            showSection.style.display = 'flex'; // Usiamo flexbox per centrare il contenuto
            showSection.offsetWidth; // Trigger reflow per animazione
            showSection.classList.add('active');
            mainContainer.classList.remove('transitioning');
        }, parseFloat(getComputedStyle(hideSection).transitionDuration) * 1000);
    }

    // Passaggio da intro (corvocarino.JPG) a pre-quiz
    introImage.addEventListener('click', () => {
        changeSection(introSection, preQuizSection, 'phase-2', 'container phase-2');
    });
    introClickableButton.addEventListener('click', () => {
        changeSection(introSection, preQuizSection, 'phase-2', 'container phase-2');
    });

    startQuizButton.addEventListener('click', () => {
        changeSection(preQuizSection, quizSection, 'phase-2', 'container phase-2');
        userAnswers.fill(undefined); // Reset risposte
        currentQuestionIndex = 0; // Inizia dalla prima domanda
        renderQuestion();
    });

    function renderQuestion() {
        quizContent.innerHTML = ''; // Pulisce il contenuto precedente
        const q = quizData[currentQuestionIndex];

        const div = document.createElement('div');
        div.classList.add('question-section');
        div.innerHTML = `<p>${currentQuestionIndex + 1}. ${q.question}</p>`; // Numera la domanda

        const optionsDiv = document.createElement('div');
        optionsDiv.classList.add('options');

        q.options.forEach((option, optionIndex) => {
            const input = document.createElement('input');
            input.type = 'radio';
            input.id = `q${currentQuestionIndex}o${optionIndex}`;
            input.name = `question${currentQuestionIndex}`;
            input.value = option;
            input.addEventListener('change', () => selectAnswer(currentQuestionIndex, option, input));

            const label = document.createElement('label');
            label.setAttribute('for', `q${currentQuestionIndex}o${optionIndex}`);
            label.innerText = option;

            optionsDiv.appendChild(input);
            optionsDiv.appendChild(label);

            // Se questa opzione era gi√† selezionata, la marchiamo come checked e con lo stile
            if (userAnswers[currentQuestionIndex] === option) {
                input.checked = true;
                label.style.backgroundColor = 'var(--quiz-primary-color)';
                label.style.borderColor = 'var(--quiz-primary-color)';
                label.style.color = 'white';
            }
        });
        div.appendChild(optionsDiv);
        quizContent.appendChild(div);

        updateNavigationButtons();
    }

    function selectAnswer(questionIndex, answer, selectedInput) {
        userAnswers[questionIndex] = answer;

        // Rimuove lo stile di selezione da tutte le opzioni della domanda corrente
        const optionsLabels = selectedInput.parentElement.querySelectorAll('label');
        optionsLabels.forEach(label => {
            label.style.backgroundColor = 'var(--quiz-container-bg)';
            label.style.borderColor = 'var(--quiz-border-color)';
            label.style.color = 'var(--quiz-text-color)';
        });

        // Applica lo stile solo all'opzione selezionata
        selectedInput.nextElementSibling.style.backgroundColor = 'var(--quiz-primary-color)';
        selectedInput.nextElementSibling.style.borderColor = 'var(--quiz-primary-color)';
        selectedInput.nextElementSibling.style.color = 'white';

        updateNavigationButtons(); // Aggiorna lo stato dei bottoni (inclusi submit)
    }

    function updateNavigationButtons() {
        prevButton.classList.toggle('hidden', currentQuestionIndex === 0);
        nextButton.classList.toggle('hidden', currentQuestionIndex === quizData.length - 1);
        submitButton.classList.toggle('hidden', currentQuestionIndex !== quizData.length - 1);

        // Abilita il pulsante "Scopri la tua verit√†" solo se tutte le domande hanno una risposta
        const allAnswered = userAnswers.every(answer => answer !== undefined);
        submitButton.disabled = !allAnswered;
    }

    prevButton.addEventListener('click', () => {
        if (currentQuestionIndex > 0) {
            currentQuestionIndex--;
            renderQuestion();
        }
    });

    nextButton.addEventListener('click', () => {
        // Controlla se la domanda attuale ha una risposta prima di passare alla successiva
        if (userAnswers[currentQuestionIndex] !== undefined) {
            if (currentQuestionIndex < quizData.length - 1) {
                currentQuestionIndex++;
                renderQuestion();
            }
        } else {
            alert("Per favore, seleziona una risposta per questa domanda prima di continuare.");
        }
    });

    submitButton.addEventListener('click', () => {
        // Una verifica finale prima di mostrare i risultati
        if (userAnswers.every(answer => answer !== undefined)) {
            showResult();
        } else {
            alert("Per favore, rispondi a tutte le domande.");
        }
    });


    function showResult() {
        const ul = document.getElementById('summary');
        ul.innerHTML = '';
        userAnswers.forEach((answer, index) => {
            const li = document.createElement('li');
            li.innerHTML = `<strong>${index + 1}. ${quizData[index].question}</strong> <br> &rarr; ${answer}`;
            ul.appendChild(li);
        });

        changeSection(quizSection, resultSection, 'phase-2', 'container phase-2');
    }

    // Condivisione WhatsApp al click sull'immagine finale
    finalImage.addEventListener('click', shareWhatsApp);

    function shareWhatsApp() {
        let whatsappMessage = "Ho scoperto il mio lato nascosto:\n\n";

        userAnswers.forEach((answer, index) => {
            whatsappMessage += `${index + 1}. ${quizData[index].question.replace(/^\d+\.\s/, '')} ‚Üí ${answer}\n`;
        });

        // Puoi aggiungere qui una frase finale se vuoi, o lasciarla vuota
        const finalPhrase = "Questa √® la mia verit√†. Scoprila anche tu!"; // Frase finale
        whatsappMessage += `\n"${finalPhrase}"`;
        whatsappMessage += `\n\nScoprilo anche tu: ${window.location.href}`; // Link del sito

        const encodedMessage = encodeURIComponent(whatsappMessage);
        const whatsappUrl = `https://wa.me/?text=${encodedMessage}`;

        window.open(whatsappUrl, '_blank');
    }

    // Inizializza i bottoni di navigazione al caricamento
    // Non chiamo renderQuestion qui perch√© inizialmente non siamo nel quiz
    // La prima domanda verr√† renderizzata quando si clicca "Inizia il Quiz"
    // updateNavigationButtons(); // Commentato perch√© non serve all'inizio
  </script>
</body>
</html>
