<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>Sorpresa üíú</title>
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@500&display=swap" rel="stylesheet">
  <style>
    body {
      background-color: #FCE7EC; /* Stesso rosa della foto della lontra */
      font-family: 'Quicksand', sans-serif;
      color: #5c2a6b;
      text-align: center;
      padding: 30px;
      overflow-x: hidden; /* Evita scroll orizzontale */
    }

    .orsetto {
      font-size: 60px;
      cursor: pointer;
      /* Animazione di "rimbalzo" costante */
      animation: bounce 2s infinite ease-in-out;
      /* Transizione rapida per effetto click e hover */
      transition: transform 0.1s ease-out;
    }

    .orsetto:hover {
      /* Leggero ingrandimento al passaggio del mouse, ma l'animazione di rimbalzo CONTINUA */
      transform: scale(1.1);
    }

    /* Animazione al click (quando l'elemento √® attivo) */
    .orsetto:active {
      transform: scale(0.9); /* L'orsetto si "comprime" leggermente al click */
    }

    /* Keyframes per l'animazione di rimbalzo dell'orso */
    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }


    .biscotti-box {
      margin-top: 20px;
      background-color: #ffe6f0;
      padding: 15px;
      border-radius: 15px;
      display: inline-block;
      border: 2px solid #e49ecf;
    }

    .biscotti-box h2 {
      margin-top: 0;
    }

    .biscotti {
      font-size: 24px;
      margin-top: 10px;
    }

    .biscotti-list {
      margin-top: 10px;
      font-size: 30px;
    }

    .heart-button {
      display: none; /* Nascosto di default, appare a 5 biscotti */
      margin-top: 20px;
      font-size: 24px;
      padding: 10px 20px;
      border: none;
      border-radius: 10px;
      background-color: #e49ecf;
      color: white;
      cursor: pointer;
      animation: sparkle 1s infinite alternate;
    }

    @keyframes sparkle {
      from { box-shadow: 0 0 10px #e49ecf; }
      to { box-shadow: 0 0 20px #ff99cc; }
    }

    .mood-bar-container {
      width: 80%;
      max-width: 700px;
      background-color: #ddd;
      border-radius: 20px;
      overflow: hidden;
      margin: 20px auto;
      height: 25px;
      border: 2px solid #ccc;
    }

    .mood-bar {
      height: 100%;
      width: 0%;
      transition: width 0.5s ease, background-color 0.5s ease;
    }


    .quiz-box, .result-box {
      display: none;
      background-color: #ffe6f0;
      padding: 20px;
      border-radius: 15px;
      border: 2px solid #e49ecf;
      margin-top: 30px;
    }

    .question {
      font-size: 20px;
      margin-bottom: 10px;
    }

    .answer {
      display: block;
      margin: 8px auto;
      background-color: #fcd6ec;
      border: none;
      padding: 10px 15px;
      border-radius: 10px;
      cursor: pointer;
      font-size: 16px;
      transition: background-color 0.3s ease;
      width: 80%;
      max-width: 300px;
    }

    .answer:hover {
      background-color: #ffc3e6;
    }

    .question-page {
      display: none;
      background-color: #FCE7EC;
      position: fixed;
      top: 0; left: 0;
      width: 100%;
      height: 100%;
      padding: 30px;
      box-sizing: border-box;
      z-index: 999;
      overflow-y: auto;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .question-content {
      background-color: #ffe6f0;
      padding: 30px;
      border-radius: 20px;
      border: 2px solid #e49ecf;
      max-width: 500px;
      text-align: center;
    }

    .otter-question-text {
      font-size: 28px;
      color: #5c2a6b;
      margin-bottom: 20px;
      font-weight: bold;
    }

    .otter-image {
      max-width: 100%;
      height: auto;
      display: block;
      margin: 0 auto 20px auto;
    }

    .like-buttons-container {
      margin-top: 30px;
      display: flex;
      justify-content: center;
      gap: 40px;
      align-items: center;
      flex-wrap: wrap;
    }

    .like-button {
      font-size: 28px;
      padding: 15px 30px;
      border: none;
      border-radius: 15px;
      cursor: pointer;
      transition: transform 0.3s ease, opacity 0.3s ease, background-color 0.3s ease;
      min-width: 150px;
      white-space: nowrap;
    }

    .yes-button {
      background-color: #e49ecf;
      color: white;
      box-shadow: 0 0 10px rgba(228, 158, 207, 0.7);
    }

    .yes-button:hover {
      background-color: #d17fb8;
      transform: scale(1.05);
    }

    .no-button {
      background-color: #fcd6ec;
      color: #5c2a6b;
      border: 2px solid #e49ecf;
    }

    .no-button:hover {
      background-color: #ffc3e6;
    }

    .twenty-biscotti-letter-page {
      display: none;
      background-color: #FCE7EC;
      position: fixed;
      top: 0; left: 0;
      width: 100%;
      height: 100%;
      padding: 30px;
      box-sizing: border-box;
      z-index: 999;
      overflow-y: auto;
    }

    .twenty-biscotti-letter-content {
      background-color: #ffe6f0;
      padding: 30px;
      border-radius: 20px;
      border: 2px solid #e49ecf;
      max-width: 600px;
      margin: 50px auto;
      font-size: 18px;
    }

    .twenty-biscotti-letter-content h2 {
        color: #e49ecf;
        margin-bottom: 20px;
        font-size: 26px;
    }

    .letter-page {
      display: none;
      background-color: #FCE7EC;
      position: fixed;
      top: 0; left: 0;
      width: 100%;
      height: 100%;
      padding: 30px;
      box-sizing: border-box;
      z-index: 999;
      overflow-y: auto;
    }

    .letter-content {
      background-color: #ffe6f0;
      padding: 30px;
      border-radius: 20px;
      border: 2px solid #e49ecf;
      max-width: 600px;
      margin: 50px auto;
      font-size: 18px;
    }

    .back-btn {
      margin-top: 20px;
      padding: 10px 20px;
      border: none;
      border-radius: 10px;
      background-color: #e49ecf;
      color: white;
      cursor: pointer;
    }
  </style>
</head>
<body>

  <div id="mainPage">
    <h1>üç™ Clicka l‚Äôorsetto per una sorpresa!</h1>
    <div class="orsetto" onclick="giveBiscotto()">üß∏</div>

    <div class="mood-bar-container">
      <div class="mood-bar" id="moodBar"></div>
    </div>

    <div class="biscotti-box">
      <h2>Biscotti üç™</h2>
      <div id="biscotti">Hai 0 biscotti!</div>
      <div class="biscotti-list" id="biscottiList"></div>
      <p id="biscotto-message" style="margin-top:10px;"></p>
      <button class="heart-button" id="heartBtn" onclick="showQuiz()">üíú</button>
    </div>

    <div class="quiz-box" id="quizBox">
      <h2>Mini Quiz üí´</h2>
      <div class="question" id="question1">
        1. Cosa fai appena torni a casa dopo una giornata pesante?
        <button class="answer" data-question-id="1" onclick="selectAnswer(0)">ü•î Mi butto sul letto come una patata</button>
        <button class="answer" data-question-id="1" onclick="selectAnswer(1)">üé¨üõèÔ∏è Apro Netflix e mi infilo sotto le coperte</button>
        <button class="answer" data-question-id="1" onclick="selectAnswer(2)">üíû Vado a cercare abbracci ovunque</button>
      </div>

      <div class="question" id="question2" style="display:none;">
        2. Che tipo di coccole preferisci?
        <button class="answer" data-question-id="2" onclick="selectAnswer(0)">ü´Ç Quelle silenziose, solo abbracci forti</button>
        <button class="answer" data-question-id="2" onclick="selectAnswer(1)">üç™üì∫ Quelle con biscotti, film e zero pensieri</button>
        <button class="answer" data-question-id="2" onclick="selectAnswer(2)">üíå Tutte, anche virtuali se servono</button>
      </div>

      <div class="question" id="question3" style="display:none;">
        3. Il tuo mood quando hai il ciclo?
        <button class="answer" data-question-id="3" onclick="selectAnswer(0)">üç´ ‚ÄúParlatemi solo se portate cioccolato‚Äù</button>
        <button class="answer" data-question-id="3" onclick="selectAnswer(1)">üí§ ‚ÄúVoglio solo dormire 18 ore‚Äù</button>
        <button class="answer" data-question-id="3" onclick="selectAnswer(2)">üêºüî• ‚ÄúSono un mix tra un panda e un drago‚Äù</button>
      </div>
    </div>

    <div class="result-box" id="resultBox"></div>
  </div>

  <div class="question-page" id="questionPage">
    <div class="question-content">
      <div class="otter-question-text">Do you like me?</div>
      <img src="castoro.JPG" alt="Un orsetto con fiori che chiede 'Do you like me?'" class="otter-image">
      <div class="like-buttons-container">
        <button id="yesButton" class="like-button yes-button">S√¨! üíú</button>
        <button id="noButton" class="like-button no-button">No... üòî</button>
      </div>
    </div>
  </div>

  <div class="twenty-biscotti-letter-page" id="twentyBiscottiLetterPage">
    <div class="twenty-biscotti-letter-content">
      <h2>Tesoro mio,</h2>
      <p>Questa non √® solo una lettera, ma un piccolo pensiero pieno d‚Äôamore per ricordarti una cosa semplice ma importantissima: ti voglio un bene infinito.</p>
      <p>Ogni giorno che passa mi rendo conto di quanto tu sia speciale per me. Il mio affetto per te resta sempre lo stesso. Sei una persona speciale, con un cuore d‚Äôoro, e mi sento davvero fortunato/a ad averti nella mia vita.</p>
      <p>Non servono grandi gesti o parole complicate per dirti quanto ci tengo: basta guardare quanto spesso ti penso e quanto il tuo sorriso riesce a cambiare anche le mie giornate pi√π grigie.</p>
      <p>Spero che questo piccolo pensiero riesca a strapparti un sorriso. Anche quando non te ne accorgi, ti porto sempre con me.</p>
      <p>Con tantissimo affetto,<br>Il tuo piccolo rompiscatole che non smette mai di pensarti üíå</p>
      <button class="back-btn" onclick="goBackFromTwentyBiscottiLetter()">üîô Torna alla pagina principale</button>
    </div>
  </div>

  <div class="letter-page" id="letterPage">
    <div class="letter-content">
      üíå Grazie per aver cliccato fino a qui‚Ä¶
      <br><br>
      Volevo solo dirti che ti voglio un bene da morire.
      Sei speciale, e anche se non posso sempre starti vicino, ci tengo davvero tanto a te.
      Ti penso spesso, anche nei momenti pi√π piccoli.
      <br><br>
      üß∏üíú
      ‚Äî Tuo rompiscatole preferito
      <br><br>
      <button class="back-btn" onclick="goBack()">üîô Torna alla pagina principale</button>
    </div>
  </div>

  <script>
    let biscotti = 0;
    let answers = [];
    let currentQuestion = 1;

    let yesScale = 1;
    let noScale = 1;
    let noOpacity = 1;

    let yesButton, noButton;

    const moodBarColors = [
        "#5c2a6b",  // 0-4 biscotti (viola scuro)
        "#8a2be2",  // 5-9 biscotti (blu violetto)
        "#ff007f",  // 10-14 biscotti (fucsia)
        "#ffa500",  // 15-19 biscotti (arancione)
        "#ff0000"   // 20 biscotti (rosso)
    ];

    function setupQuestionPageButtons() {
        if (!yesButton) {
            yesButton = document.getElementById('yesButton');
            noButton = document.getElementById('noButton');

            noButton.addEventListener('click', () => {
                noScale = Math.max(0.05, noScale - 0.2);
                yesScale = Math.min(2.5, yesScale + 0.25);
                noOpacity = Math.max(0, noOpacity - 0.25);

                updateButtonSizes();
            });

            yesButton.addEventListener('click', () => {
                showLetterPage();
            });
        }
    }

    function updateButtonSizes() {
        if (yesButton && noButton) {
            yesButton.style.transform = `scale(${yesScale})`;
            noButton.style.transform = `scale(${noScale})`;
            noButton.style.opacity = noOpacity;

            if (noScale < 0.2 || noOpacity < 0.1) {
                noButton.style.pointerEvents = 'none';
                noButton.style.display = 'none';
            } else {
                noButton.style.pointerEvents = 'auto';
                noButton.style.display = 'block';
            }
        }
    }

    function giveBiscotto() {
      biscotti++;
      document.getElementById('biscotti').innerText = `Hai ${biscotti} biscotti!`;
      document.getElementById('biscotto-message').innerText = "Anche se non sono l√¨ con te, tieni questo üç™";

      const biscottiList = document.getElementById('biscottiList');
      const newBiscotto = document.createElement("span");
      newBiscotto.innerText = "üç™ ";
      biscottiList.appendChild(newBiscotto);

      updateMoodBar();

      if (biscotti >= 5) {
        document.getElementById('heartBtn').style.display = "inline-block";
      }

      if (biscotti === 20) {
          showTwentyBiscottiLetter();
      }
    }

    function updateMoodBar() {
      const bar = document.getElementById('moodBar');
      let percentage = Math.min((biscotti / 20) * 100, 100);
      bar.style.width = percentage + "%";

      let colorIndex;
      if (biscotti <= 4) {
          colorIndex = 0;
      } else if (biscotti <= 9) {
          colorIndex = 1;
      } else if (biscotti <= 14) {
          colorIndex = 2;
      } else if (biscotti <= 19) {
          colorIndex = 3;
      } else { // biscotti >= 20
          colorIndex = 4;
      }
      bar.style.backgroundColor = moodBarColors[colorIndex];
    }

    function showTwentyBiscottiLetter() {
        document.getElementById('mainPage').style.display = "none";
        document.getElementById('quizBox').style.display = "none";
        document.getElementById('resultBox').style.display = "none";
        document.getElementById('questionPage').style.display = "none";
        document.getElementById('letterPage').style.display = "none";
        document.getElementById('twentyBiscottiLetterPage').style.display = "block";
    }

    function showLetterPage() {
        document.getElementById('questionPage').style.display = "none";
        document.getElementById('mainPage').style.display = "none";
        document.getElementById('quizBox').style.display = "none";
        document.getElementById('resultBox').style.display = "none";
        document.getElementById('twentyBiscottiLetterPage').style.display = "none";
        document.getElementById('letterPage').style.display = "block";

        if (yesButton) {
            yesButton.style.animation = 'sparkle 1s infinite alternate';
            setTimeout(() => {
                if (yesButton) {
                    yesButton.style.animation = '';
                }
            }, 2000);
        }
    }

    function showQuiz() {
      document.getElementById('quizBox').style.display = "block";
      showQuestion(1);
    }

    function showQuestion(n) {
        document.querySelectorAll('.quiz-box .question').forEach(q => q.style.display = 'none');
        const currentQ = document.getElementById(`question${n}`);
        if (currentQ) {
            currentQ.style.display = 'block';
            document.querySelectorAll(`.answer[data-question-id="${n}"]`).forEach(btn => {
                btn.style.display = "block";
            });
        }
    }

    function selectAnswer(val) {
      answers.push(val);
      currentQuestion++;
      if (currentQuestion <= 3) {
        showQuestion(currentQuestion);
      } else {
        showResult();
      }
    }

    function showResult() {
      let resultText = "";
      const total = answers.reduce((a, b) => a + b, 0);
      if (total <= 2) resultText = "ü•î Patatella da coccolare";
      else if (total <= 4) resultText = "üëë Regina del Relax";
      else resultText = "üêØ Tigre tenera con cuore gigante";

      document.getElementById('quizBox').style.display = "none";
      document.getElementById('resultBox').style.display = "block";
      document.getElementById('resultBox').innerHTML = `<h2>Risultato:</h2><p>${resultText}</p>`;

      setTimeout(() => {
        document.getElementById('mainPage').style.display = "none";
        document.getElementById('resultBox').style.display = "none";
        document.getElementById('twentyBiscottiLetterPage').style.display = "none";
        document.getElementById('questionPage').style.display = "flex";

        yesScale = 1;
        noScale = 1;
        noOpacity = 1;
        setupQuestionPageButtons();
        updateButtonSizes();
      }, 1500);
    }

    function goBackFromTwentyBiscottiLetter() {
        document.getElementById('twentyBiscottiLetterPage').style.display = "none";
        document.getElementById('mainPage').style.display = "block";
        resetAppState();
    }

    function goBack() {
      document.getElementById('letterPage').style.display = "none";
      document.getElementById('mainPage').style.display = "block";
      resetAppState();
    }

    function resetAppState() {
        biscotti = 0;
        document.getElementById('biscotti').innerText = `Hai ${biscotti} biscotti!`;
        document.getElementById('biscottiList').innerHTML = "";
        document.getElementById('biscotto-message').innerText = "";
        document.getElementById('heartBtn').style.display = "none";
        updateMoodBar();
        answers = [];
        currentQuestion = 1;
        document.getElementById('quizBox').style.display = "none";
        document.getElementById('resultBox').style.display = "none";
    }

    document.addEventListener('DOMContentLoaded', () => {
        setupQuestionPageButtons();
        document.getElementById('questionPage').style.display = 'none';
        document.getElementById('letterPage').style.display = 'none';
        document.getElementById('twentyBiscottiLetterPage').style.display = 'none';
        document.getElementById('mainPage').style.display = 'block';
        updateMoodBar();
    });
  </script>
</body>
</html>
