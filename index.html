<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sai quanto ti amo?</title>
  <link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Inter:wght@400;700&display=swap" rel="stylesheet">
  <style>
    /* Variabili CSS */
    :root {
      /* Colori Fase 1 (Introduzione) */
      --intro-bg-color: #fef1f5; /* Rosa chiaro */
      --intro-text-color: #333; /* Testo scuro */
      --intro-clickable-hover: #ffc8d3; /* Hover per l'immagine cliccabile */

      /* Colori Fase 2 (Quiz - Sfondo viola scuro) */
      --quiz-bg-color: #372D56; /* Viola scuro dominante dall'immagine del corvo che dorme */
      --quiz-text-color: #F5F5F5; /* Testo molto chiaro per leggibilit√† su sfondo scuro */
      --quiz-font: 'Inter', sans-serif;
      --quiz-primary-color: #6a05ad; /* Viola scuro/intenso per bottoni/selezione */
      --quiz-button-hover-color: #8b008b;
      --quiz-border-color: #C8C1DA; /* Bordo pi√π chiaro per contrasto */
      --quiz-container-bg: rgba(55, 45, 86, 0.9); /* Container viola scuro leggermente trasparente */
      --quiz-shadow-color: rgba(0, 0, 0, 0.4);
      --quiz-selected-option-color: #A799FF; /* Viola pastello dolce per opzione selezionata */
      --quiz-question-color: #E0E0E0; /* Domande in un colore molto chiaro su sfondo scuro */

      /* Colori Fase 3 (Risultato e Immagini Finali - Sfondo viola scuro come corvo) */
      --result-bg-color: #372D56; /* Viola scuro come sfondo del corvo che dorme */
      --result-text-color: #333; /* Testo scuro per il container bianco del riepilogo */
      --result-primary-color: #6a05ad;
      --result-container-bg: #f5f3ff; /* Container risultato viola chiaro */
      --result-shadow-color: rgba(0, 0, 0, 0.15); /* Ombra normale per il container */

      --transition-speed: 0.8s;
      --neon-color1: #ff00ff; /* Magenta */
      --neon-color2: #8a2be2; /* BlueViolet */
    }

    body {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: var(--intro-bg-color);
      color: var(--intro-text-color);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      transition: background-color var(--transition-speed) ease, color var(--transition-speed) ease;
      text-align: center;
      position: relative;
      overflow-x: hidden;
    }

    #app {
      max-width: 90%;
      width: 100%;
      padding: 20px;
      box-sizing: border-box;
      position: relative;
      min-height: 500px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      transition: background-color var(--transition-speed) ease, box-shadow var(--transition-speed) ease, padding var(--transition-speed) ease;
    }

    /* Stili per la Fase 2 (Quiz) */
    body.phase-2 {
        background-color: var(--quiz-bg-color);
        color: var(--quiz-text-color);
        font-family: var(--quiz-font);
    }
    #app.phase-2 {
        background-color: var(--quiz-container-bg);
        box-shadow: 0 8px 20px var(--quiz-shadow-color);
        max-width: 95%;
        padding: 30px 20px;
        color: var(--quiz-text-color);
    }

    /* Stili per la Fase 3 (Risultato e Immagini Finali) */
    body.phase-3 {
        background-color: var(--result-bg-color);
        color: var(--result-text-color);
        font-family: var(--quiz-font);
    }
    #app.phase-3 {
        background-color: var(--result-container-bg);
        box-shadow: 0 8px 20px var(--result-shadow-color);
        max-width: 95%;
        padding: 30px 20px;
        color: var(--result-text-color);
        min-height: auto;
        height: auto;
        padding-bottom: 20px;
        display: flex;
        flex-direction: column;
        align-items: center;
    }
    #app.phase-3.final-images {
        background-color: transparent; /* Sfondo dell'app trasparente per mostrare il background del body */
        box-shadow: none;
        color: var(--quiz-text-color); /* Per il testo della lettera */
    }


    .hidden {
      display: none !important;
    }

    /* Stili introduttivi romantici con font originale */
    #intro h1 {
        font-family: 'Segoe UI', sans-serif;
        color: #e91e63;
        font-size: 2.8em;
        margin-bottom: 10px;
        text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
    }
    #intro p {
        font-family: 'Segoe UI', sans-serif;
        font-size: 1.2em;
        color: #555;
        margin-bottom: 30px;
        line-height: 1.5;
    }

    /* Immagine intro con bordo circolare e ombra */
    #intro-image {
        width: 180px;
        height: 180px;
        border-radius: 50%;
        object-fit: cover;
        cursor: pointer;
        transition: transform 0.3s ease-out, box-shadow 0.3s ease-out;
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.25);
        margin-top: 20px;
        border: 4px solid var(--intro-clickable-hover);
    }
    #intro-image:hover {
        transform: scale(1.08);
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.4);
    }

    /* Stili per la pagina "Ora che hai cliccato..." */
    #pre-quiz-section h2 {
        color: white;
        margin-bottom: 25px;
        font-weight: 700;
    }
    /* Stili per il quiz vero e proprio */
    #quiz-section h2 {
        color: var(--quiz-primary-color);
        margin-bottom: 25px;
        font-weight: 700;
    }
    /* Stili per la pagina dei risultati */
    #result-section h2 {
        color: var(--result-primary-color);
        margin-bottom: 25px;
        font-weight: 700;
    }

    /* Pulsante/Immagine "Inizia il Quiz" circolare con bordo neon */
    #start-quiz-image {
        width: 200px;
        height: 200px;
        object-fit: cover;
        border-radius: 50%;
        cursor: pointer;
        transition: transform 0.3s ease-out, box-shadow 0.3s ease-out;
        box-shadow: 0 0 10px 2px var(--neon-color1), 0 0 20px 6px var(--neon-color2);
        margin-top: 30px;
        border: 4px solid var(--quiz-primary-color);
    }
    #start-quiz-image:hover {
        transform: scale(1.05);
        box-shadow: 0 0 15px 3px var(--neon-color1), 0 0 25px 8px var(--neon-color2);
    }


    .question-section {
        margin-bottom: 30px;
        text-align: left;
        width: 100%;
    }

    .question-section p {
      font-size: 1.15em;
      margin-bottom: 15px;
      color: var(--quiz-question-color);
      font-weight: bold;
    }

    .options label {
        display: block;
        background-color: var(--quiz-container-bg);
        padding: 15px;
        margin-bottom: 10px;
        border-radius: 8px;
        cursor: pointer;
        transition: background-color 0.3s ease, border-color 0.3s ease;
        border: 1px solid var(--quiz-border-color);
        font-size: 1em;
        color: var(--quiz-text-color);
        box-shadow: 0 0 5px 1px var(--neon-color1), 0 0 10px 3px var(--neon-color2);
    }

    .options label:hover {
        background-color: rgba(255, 255, 255, 0.2);
        border-color: var(--quiz-primary-color);
    }

    .options input[type="radio"] {
        display: none;
    }

    /* Stile per l'opzione selezionata (viola pastello) */
    .options input[type="radio"]:checked + label {
        background-color: var(--quiz-selected-option-color);
        border-color: var(--quiz-primary-color);
        color: white;
        box-shadow: 0 0 10px 2px var(--neon-color1), 0 0 20px 6px var(--neon-color2);
    }

    .action-button {
        background-color: var(--quiz-primary-color);
        color: white;
        border: none;
        padding: 15px 25px;
        border-radius: 8px;
        font-size: 1.1em;
        cursor: pointer;
        transition: background-color 0.3s ease, transform 0.2s ease;
        margin-top: 20px;
        box-shadow: 0 0 10px 2px var(--neon-color1), 0 0 15px 5px var(--neon-color2);
    }

    .action-button:hover {
        background-color: var(--quiz-button-hover-color);
        transform: translateY(-2px);
    }

    .action-button:disabled {
        background-color: #999;
        cursor: not-allowed;
        transform: translateY(0);
    }

    #summary {
        list-style: none;
        padding: 0;
        margin-bottom: 20px;
        text-align: left;
        width: 100%;
        color: var(--result-text-color); /* Assicurati che il testo del summary sia scuro */
    }
    #summary li {
        margin-bottom: 10px;
        line-height: 1.4;
    }
    #summary strong {
        display: block;
        margin-bottom: 5px;
        color: var(--result-primary-color); /* Colore pi√π evidente per le domande */
    }

    #final-phrase {
        font-size: 1.4em;
        font-style: italic;
        margin-bottom: 30px;
        color: var(--result-primary-color);
        word-wrap: break-word;
        text-align: center;
        width: 100%;
    }

    /* Stili per il pulsante "Avanti" (freccia) */
    .next-button {
        background: none;
        border: none;
        font-size: 3em; /* Rendi la freccia grande e visibile */
        color: var(--quiz-primary-color); /* Colore viola */
        cursor: pointer;
        transition: transform 0.2s ease, color 0.2s ease;
        padding: 10px;
        margin-top: 20px;
        text-shadow: 0 0 8px var(--neon-color1); /* Piccola ombra neon */
    }

    .next-button:hover {
        transform: translateX(5px); /* Sposta leggermente a destra all'hover */
        color: var(--neon-color1); /* Cambia colore all'hover */
    }


    /* Contenitore per le due immagini finali */
    #final-images-container {
        display: flex;
        flex-direction: row; /* Immagini affiancate */
        justify-content: center;
        align-items: center;
        gap: 30px; /* Spazio tra le immagini */
        margin-top: 40px; /* Spazio dal bordo superiore */
        width: 100%;
        min-height: 200px; /* Altezza minima per contenere le immagini */
        transition: opacity 0.5s ease-in-out;
        opacity: 0; /* Inizialmente nascosto */
    }

    #final-images-container.show {
        opacity: 1;
    }

    .final-image-item {
        width: 150px;
        height: 150px;
        border-radius: 50%;
        object-fit: cover;
        cursor: pointer;
        transition: transform 0.3s ease-out, box-shadow 0.3s ease-out;
        box-shadow: 0 0 15px 5px var(--neon-color1), 0 0 25px 10px var(--neon-color2);
        border: 4px solid transparent; /* Base per il bordo neon */
    }

    .final-image-item:hover {
        transform: scale(1.1);
    }

    /* Stili per la lettera d'amore */
    #love-letter {
        background-color: white; /* Sfondo bianco per la leggibilit√† */
        color: #333; /* Testo scuro */
        padding: 30px;
        border-radius: 10px;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        max-width: 600px;
        margin: 20px auto;
        text-align: left;
        line-height: 1.6;
        font-family: var(--quiz-font);
        box-sizing: border-box; /* Include padding e border nella larghezza totale */
    }

    #love-letter h2 {
        color: var(--quiz-primary-color);
        text-align: center;
        margin-bottom: 25px;
        font-size: 1.8em;
    }

    #love-letter p {
        margin-bottom: 15px;
        font-size: 1.1em;
    }

    #love-letter em {
        display: block;
        text-align: right;
        margin-top: 30px;
        font-size: 1.2em;
        color: var(--quiz-primary-color);
    }

    /* Media queries per una migliore responsivit√† */
    @media (max-width: 600px) {
        #app {
            padding: 20px;
            margin: 10px;
            max-width: 98%; /* Pi√π largo su schermi piccoli */
        }

        #intro h1 {
            font-size: 2.2em;
        }
        #intro p {
            font-size: 1em;
        }
        #intro-image {
            width: 150px;
            height: 150px;
        }

        #pre-quiz-section h2, #quiz-section h2, #result-section h2 {
            font-size: 1.6em;
        }

        .question-section p {
            font-size: 1em;
        }

        .options label {
            padding: 12px;
            font-size: 0.95em;
        }

        .action-button {
            padding: 12px 20px;
            font-size: 1em;
        }

        #final-phrase {
            font-size: 1.2em;
        }

        #final-images-container {
            flex-direction: column; /* Immagini impilate su schermi piccoli */
            gap: 20px;
        }

        .final-image-item {
            width: 120px;
            height: 120px;
        }

        .next-button {
            font-size: 2.5em;
        }

        #love-letter {
            padding: 20px;
            font-size: 0.95em;
        }

        #love-letter h2 {
            font-size: 1.5em;
        }
    }
  </style>
</head>
<body class="phase-1">
  <div id="app">
    </div>

  <script>
    const app = document.getElementById('app');
    const body = document.body;
    let userAnswers = []; // Array per memorizzare le risposte dell'utente (testo)
    let currentQuestionIndex = 0;
    let finalEffectPhrase = ""; // Variabile per memorizzare la frase d'effetto dell'ultima risposta

    const quizData = [
      {
        question: "Qual √® la verit√† che ti fa pi√π male ammettere?",
        options: [
          { text: "Che non sono abbastanza.", effectPhrase: "A forza di sforzarti per valere qualcosa, hai smesso di guardarti con tenerezza." },
          { text: "Che se sparissi, non cambierebbe niente.", effectPhrase: "Ti annulli a piccoli passi, sperando che qualcuno dica ‚Äúresta‚Äù." },
          { text: "Che faccio ridere anche quando mi spezzo.", effectPhrase: "Nessuno ti ha mai chiesto se stavi bene mentre li facevi sorridere." },
          { text: "Che ho bisogno, ma non lo dico.", effectPhrase: "Hai imparato a nascondere la fame d‚Äôamore sotto sorrisi controllati." }
        ]
      },
      {
        question: "Quando stai male, cosa fai finta di essere?",
        options: [
          { text: "Impegnato.", effectPhrase: "Sei bravo a sembrare calmo, ma dentro a volte tremi senza un suono." },
          { text: "Tranquillo.", effectPhrase: "Ogni tuo ‚Äúva tutto bene‚Äù nasconde una tempesta che solo tu sai reggere." },
          { text: "Distratto.", effectPhrase: "Ti perdi nei pensieri pur di non far vedere quanto hai bisogno di essere visto." },
          { text: "Fortissimo.", effectPhrase: "Hai fatto della forza una maschera, ma anche i giganti si stancano." }
        ]
      },
      {
        question: "Cosa ti √® mancato pi√π di tutto?",
        options: [
          { text: "Qualcuno che mi ascoltasse davvero.", effectPhrase: "Hai imparato a non chiedere pi√π, ma il bisogno √® rimasto in silenzio dentro di te." },
          { text: "Un abbraccio sincero.", effectPhrase: "Ti manca ci√≤ che non hai mai ricevuto davvero: un abbraccio che dicesse ‚Äúci sono‚Äù." },
          { text: "Una voce che mi dicesse ‚Äúresta‚Äù.", effectPhrase: "Hai aspettato quella voce, e forse la stai ancora aspettando." },
          { text: "Una volta in cui non mi sono sentito di troppo.", effectPhrase: "Ogni volta che ti sei sentito di troppo, hai costruito muri che ora ti stringono." }
        ]
      },
      {
        question: "A chi avresti voluto dire qualcosa, ma non l‚Äôhai fatto?",
        options: [
          { text: "A chi mi ha dimenticato.", effectPhrase: "Ci sono parole che hai sepolto per non disturbare. Ma gridano ancora, dentro." },
          { text: "A me stesso, quando avevo paura.", effectPhrase: "Hai lasciato andare per proteggerti, ma certe paure andavano abbracciate." },
          { text: "A chi mi ha usato.", effectPhrase: "Chi ti ha usato non ha tolto valore a ci√≤ che sei. Solo luce a ci√≤ che dai." },
          { text: "A chi ho lasciato andare senza capirmi.", effectPhrase: "Non capirti non √® colpa tua. E anche nel silenzio, vali." }
        ]
      },
      {
        question: "Qual √® il pensiero che ti fa pi√π male, anche se non lo dici?",
        options: [
          { text: "Che forse non sar√≤ mai scelto.", effectPhrase: "Ti tormenti col dubbio di non essere scelto, ma l‚Äôamore non √® una selezione." },
          { text: "Che chi dice di amarmi non mi vede.", effectPhrase: "Essere visti davvero √® raro. Ma tu meriti occhi che restano." },
          { text: "Che nessuno resterebbe se sapesse tutto.", effectPhrase: "Se anche mostrassi tutto, resterebbe chi ti ama per intero." },
          { text: "Che valgo solo quando sorrido.", effectPhrase: "Non sei solo il tuo sorriso. Sei anche ci√≤ che nascondi dietro." }
        ]
      },
      {
        question: "Quando hai pianto da solo, cosa ti sei detto?",
        options: [
          { text: "‚ÄúDevo smettere.‚Äù", effectPhrase: "Ti sei detto che dovevi smettere. Ma sentire non √® mai una colpa." },
          { text: "‚ÄúTanto nessuno capirebbe.‚Äù", effectPhrase: "Non sei strano per essere fragile. Sei umano per esserlo in silenzio." },
          { text: "‚ÄúNon posso crollare adesso.‚Äù", effectPhrase: "Hai tenuto in piedi il mondo quando il tuo stava crollando." },
          { text: "‚ÄúAlmeno qui non mi vede nessuno.‚Äù", effectPhrase: "Il buio non ti ha mai fatto paura: solo non essere visto dentro di esso." }
        ]
      },
      {
        question: "Cosa tieni nascosto anche a chi ti ama?",
        options: [
          { text: "La mia rabbia silenziosa.", effectPhrase: "La tua rabbia silenziosa ha un cuore buono che non √® stato ascoltato." },
          { text: "La voglia di sparire.", effectPhrase: "Non √® fuga. √à sopravvivenza. Ma ora puoi anche restare." },
          { text: "Tutte le volte che mi sento finto.", effectPhrase: "Non sei finto. Sei solo stanco di fingere di stare bene." },
          { text: "I pensieri che mi fanno paura.", effectPhrase: "Ci√≤ che ti spaventa non ti rende debole. Ti rende vero." }
        ]
      },
      {
        question: "Cosa speri ancora, ma non lo ammetteresti mai?",
        options: [
          { text: "Che qualcuno mi scelga e resti.", effectPhrase: "Vorresti qualcuno che ti scegliesse anche nei tuoi giorni pi√π bui." },
          { text: "Che io possa smettere di fingere.", effectPhrase: "Smettere di fingere sarebbe il tuo primo vero respiro." },
          { text: "Che il dolore un giorno serva a qualcosa.", effectPhrase: "Hai dato un senso al dolore degli altri. Ora meriti che il tuo ne abbia uno." },
          { text: "Che qualcuno dica: ‚ÄúNon importa, resto comunque.‚Äù", effectPhrase: "‚ÄúResto comunque‚Äù √® la frase che avresti voluto sentire. E la meriti." }
        ]
      }
    ];

    function renderIntro() {
        app.innerHTML = `
            <div id="intro">
                <h1>Sai quanto ti amo?</h1>
                <p>Clicca per scoprire il mio amore verso di te.</p>
                <img src="corvocarino.JPG" alt="Corvo carino" id="intro-image">
            </div>
        `;
        body.className = 'phase-1';
        app.className = ''; // Rimuovi classi specifiche del container
        document.getElementById('intro-image').addEventListener('click', renderPreQuiz);
    }

    function renderPreQuiz() {
        app.innerHTML = `
            <div id="pre-quiz-section">
                <h2>Ora che hai cliccato‚Ä¶ vediamo il tuo lato nascosto.</h2>
                <img src="corvodorme.JPG" alt="Inizia il Quiz" id="start-quiz-image">
            </div>
        `;
        body.className = 'phase-2';
        app.className = 'phase-2'; // Applica classi per il container
        document.getElementById('start-quiz-image').addEventListener('click', renderQuiz);
    }

    function renderQuiz() {
        if (userAnswers.length === 0) { // Inizializza le risposte alla prima entrata
            userAnswers = new Array(quizData.length).fill(undefined);
        }

        const q = quizData[currentQuestionIndex];
        let optionsHtml = '';
        q.options.forEach((option, optionIndex) => {
            const checked = userAnswers[currentQuestionIndex] === option.text ? 'checked' : '';
            const selectedStyle = userAnswers[currentQuestionIndex] === option.text ?
                'background-color: var(--quiz-selected-option-color); border-color: var(--quiz-primary-color); color: white;' : '';
            optionsHtml += `
                <input type="radio" id="q${currentQuestionIndex}o${optionIndex}" name="question${currentQuestionIndex}" value="${option.text}" data-effect-phrase="${option.effectPhrase}" ${checked}>
                <label for="q${currentQuestionIndex}o${optionIndex}" style="${selectedStyle}">${option.text}</label>
            `;
        });

        app.innerHTML = `
            <div id="quiz-section">
                <div id="quizContent">
                    <div class="question-section">
                        <p>${currentQuestionIndex + 1}. ${q.question}</p>
                        <div class="options">${optionsHtml}</div>
                    </div>
                </div>
            </div>
        `;
        body.className = 'phase-2';
        app.className = 'phase-2'; // Applica classi per il container

        // Aggiungi listener per le opzioni
        document.querySelectorAll(`#quizContent input[type="radio"]`).forEach(input => {
            input.addEventListener('change', (event) => {
                // Salva sia la risposta che la frase d'effetto
                selectAnswer(currentQuestionIndex, event.target.value, event.target.dataset.effectPhrase, event.target);
                // Avanza alla prossima domanda o mostra il risultato automaticamente
                setTimeout(() => { // Piccolo ritardo per visualizzare la selezione
                    if (currentQuestionIndex < quizData.length - 1) {
                        currentQuestionIndex++;
                        renderQuiz();
                    } else {
                        renderResult();
                    }
                }, 300); // 300ms di ritardo
            });
        });
    }

    function selectAnswer(questionIndex, answerText, effectPhrase, selectedInput) {
        userAnswers[questionIndex] = answerText;
        // Aggiorna la frase d'effetto finale con quella dell'ultima risposta selezionata
        finalEffectPhrase = effectPhrase;

        // Resetta gli stili di tutte le opzioni della domanda corrente
        const optionsLabels = selectedInput.parentElement.querySelectorAll('label');
        optionsLabels.forEach(label => {
            label.style.backgroundColor = 'var(--quiz-container-bg)';
            label.style.borderColor = 'var(--quiz-border-color)';
            label.style.color = 'var(--quiz-text-color)';
            label.style.boxShadow = '0 0 5px 1px var(--neon-color1), 0 0 10px 3px var(--neon-color2)';
        });

        // Applica gli stili per l'opzione selezionata
        selectedInput.nextElementSibling.style.backgroundColor = 'var(--quiz-selected-option-color)';
        selectedInput.nextElementSibling.style.borderColor = 'var(--quiz-primary-color)';
        selectedInput.nextElementSibling.style.color = 'white';
        selectedInput.nextElementSibling.style.boxShadow = '0 0 10px 2px var(--neon-color1), 0 0 20px 6px var(--neon-color2)';
    }


    function renderResult() {
        let summaryHtml = '';
        userAnswers.forEach((answer, index) => {
            summaryHtml += `
                <li>
                    <strong>${index + 1}. ${quizData[index].question}</strong> <br> &rarr; ${answer}
                </li>
            `;
        });

        app.innerHTML = `
            <div id="result-section">
                <h2>La verit√† che non dici</h2>
                <ul id="summary">${summaryHtml}</ul>
                <p id="final-phrase">${finalEffectPhrase}</p>
                <button class="next-button" id="proceed-to-final-images">‚û°Ô∏è</button>
            </div>
        `;
        body.className = 'phase-3';
        app.className = 'phase-3'; // Applica classi per il container

        document.getElementById('proceed-to-final-images').addEventListener('click', renderFinalContent);
    }

    function renderFinalContent() {
        app.innerHTML = `
            <div id="final-images-container">
                <img src="corvo.JPG" alt="Condividi su WhatsApp" class="final-image-item" id="whatsapp-image">
                <img src="corvolettera.JPG" alt="Leggi la lettera" class="final-image-item" id="letter-image">
            </div>
        `;
        // Applica le classi per il background e il colore del testo della fase 3
        body.className = 'phase-3';
        app.className = 'phase-3 final-images'; // Aggiungi una classe specifica per le immagini finali, forse con background trasparente per l'app

        // Mostra il contenitore delle immagini con transizione
        const finalImagesContainer = document.getElementById('final-images-container');
        setTimeout(() => {
            finalImagesContainer.classList.add('show');
        }, 50); // Piccolo ritardo per l'effetto di transizione

        document.getElementById('whatsapp-image').addEventListener('click', shareWhatsApp);
        document.getElementById('letter-image').addEventListener('click', renderLoveLetter);
    }

    function shareWhatsApp() {
        let whatsappMessage = "Ho scoperto il mio lato nascosto:\n\n";

        userAnswers.forEach((answer, index) => {
            whatsappMessage += `${index + 1}. ${quizData[index].question} ‚Üí ${answer}\n`;
        });

        whatsappMessage += `\n"${finalEffectPhrase}"`; // Usa la frase d'effetto dell'ultima risposta
        whatsappMessage += `\n\nScoprilo anche tu: ${window.location.href}`;

        const encodedMessage = encodeURIComponent(whatsappMessage);
        const whatsappUrl = `https://wa.me/?text=${encodedMessage}`;

        window.open(whatsappUrl, '_blank');
    }

    function renderLoveLetter() {
        app.innerHTML = `
            <div id="love-letter">
              <h2>Il corvo ti ha mandato la letteraüê¶‚Äç‚¨õüíú</h2>

              <p>Tu non sei sola.  
              Nemmeno quando il mondo sembra troppo,  
              nemmeno quando pensi che nessuno ti stia guardando davvero.</p>

              <p>Io ti vedo.  
              Ti vedo anche quando non dici niente.  
              Quando trattieni tutto, quando abbassi gli occhi, quando dici ‚Äútanto passa‚Äù ma dentro ti spegni un po‚Äô.</p>

              <p>Io ti leggo.  
              E non serve che tu spieghi tutto per filo e per segno: certe cose le sento.  
              Le leggo nel modo in cui respiri piano, nel modo in cui ti chiudi ma vorresti essere abbracciata lo stesso.</p>

              <p>Tu sei vista. E capita, anche nei pezzi che credi di dover nascondere.  
              Io ti tengo dentro, anche quando non so bene come dirtelo.</p>

              <p>√à vero, magari non sempre riesco a supportarti nel modo perfetto.  
              A volte mi perdo nel cercare le parole giuste, o ho paura di sbagliare.  </p>

              <p>Per√≤ tu, tu sei tutto quello che non passa inosservato.  
              Anche quando sei fragile. Anche quando dici che stai bene ma hai lo sguardo stanco.  
              E io ci sono. Davvero. Con tutto quello che sono, anche con i miei sbagli.</p>

              <p>Il corvo ti ha portato questa lettera.  
              Ma ogni parola l‚Äôho scritta io, a modo mio.  
              Per dirti solo questo:  
              <strong>tu non sei sola. Non lo sei mai stata.</strong></p>

              <p><em>Il tuo rimbambito üíú</em></p>
            </div>
            <button class="action-button" onclick="window.location.reload()">Ricomincia</button>
        `;
        // Assicurati che lo sfondo del body rimanga quello della fase 3
        body.className = 'phase-3';
        // Rimuovi la classe 'final-images' dall'app se presente, per resettare gli stili del contenitore se la lettera non √® trasparente
        app.className = 'phase-3';
        // Imposta un'altezza automatica per l'app in modo che la lettera non sia tagliata
        app.style.minHeight = 'auto';
        app.style.height = 'auto';
        app.style.justifyContent = 'flex-start'; // Allinea il contenuto in alto per la lettera
    }

    // Inizializza l'applicazione mostrando la prima fase
    renderIntro();
  </script>
</body>
</html>
